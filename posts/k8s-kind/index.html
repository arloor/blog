<!DOCTYPE html>
<html lang="zh-CN">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    
    <link rel="canonical" href="https://www.arloor.com/posts/k8s-kind/">
    
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.136.4">

    
    
    

<title>K8s Kind使用 • ARLOOR</title>
<meta name="description" content="今天，你学习了吗">
<meta name="keywords" content="刘港欢, arloor, moontell">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="K8s Kind使用">
  <meta name="twitter:description" content="简单使用下kind">
      <meta name="twitter:site" content="@njulgh">

<meta property="og:url" content="https://www.arloor.com/posts/k8s-kind/">
  <meta property="og:site_name" content="ARLOOR">
  <meta property="og:title" content="K8s Kind使用">
  <meta property="og:description" content="简单使用下kind">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-07-18T20:15:30+08:00">
    <meta property="article:modified_time" content="2023-07-18T20:15:30+08:00">
    <meta property="article:tag" content="K8s">


    





<link rel="stylesheet" href="/styles/atom-one-dark.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.484b96856b25751067d56c8c0af9dc1fd6372707029b6d56ee178da6bead45b5.css" integrity="sha256-SEuWhWsldRBn1WyMCvncH9Y3JwcCm21W7heNpr6tRbU=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">




<link rel="stylesheet" href="/scss/hugo-toc.0873834b0f2e9fdc9e1d0301e8ebce21fc10383882a41e9373f29b90e85a9987.css" integrity="sha256-CHODSw8un9yeHQMB6OvOIfwQODiCpB6Tc/KbkOhamYc=">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    

</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="/">
          
          ARLOOR
          
        </a>
      </span>
      <a href="/">
        
        
        <div class="author-image">
          <img src="/img/head.jpeg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
        
      </a>
      
      <p class="site__description">
         都是瞎写的 
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">ARLOOR</label>
      <div class="menu-content">
        <div class="show-in-small">
          <a href="/">
            
            
            <div class="author-image">
              <img src="/img/head.jpeg" alt="Author Image"
                class="img--circle img--headshot element--center">
            </div>
            
            
          </a>
        </div>
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/posts/">
						<span>文章</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/tags/">
						<span>分类</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about/">
						<span>关于我</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="http://beian.miit.gov.cn/">
						<span>苏ICP备17024437号</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <section class="social">
	
	<a href="https://x.com/njulgh" rel="me"><i class="fa-brands fa-x-twitter fa-lg"></i></a>
	
	
	
	
	
	<a href="https://github.com/arloor" rel="me"><i class="fa-brands fa-github fa-lg"></i></a>
	
	
	
	
	
	
	
	
	
	
	
	
	
	<a href="https://t.me/never_contact_me" rel="me"><i class="fa-brands fa-telegram fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	<a href="mailto:admin@arloor.com" rel="me"><i class="fa-solid fa-at fa-lg"></i></a>
	
	
	
	
</section>
      </div>
    </div>
    
<div class="copyright">
  &copy; 2024 arloor
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/arloor/hyde-arloor">hyde-arloor</a>.
</div>


  </div>
</div>
        <div class="content container">
            
    
<article>
  <header>
    <h1>K8s Kind使用</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Jul 18, 2023
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/categories/undefined">UNDEFINED</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/k8s">k8s</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 3 min read
</div>


  </header>
  
  
  
    <div class="toc-wrapper">
      <input type="checkbox" id="tocToggle">
      <label for="tocToggle">Table of Content</label>
      
          <nav id="TableOfContents">
  <ul>
    <li><a href="#kubectl">kubectl</a></li>
    <li><a href="#kind">kind</a>
      <ul>
        <li><a href="#安装kind">安装kind</a></li>
        <li><a href="#创建cluster">创建cluster</a></li>
        <li><a href="#删除集群">删除集群</a></li>
        <li><a href="#将docker镜像加载到cluster中">将docker镜像加载到cluster中</a></li>
        <li><a href="#进入控制面看看">进入控制面看看</a></li>
        <li><a href="#创建工作负载">创建工作负载</a></li>
      </ul>
    </li>
  </ul>
</nav>
      
    </div>
  
  
  <div class="post">
    <p>简单使用下kind</p>
<p>环境：rhel9.2</p>
<ul>
<li><a href="https://kubernetes.io/docs/tasks/tools/">Install Tools</a></li>
<li><a href="https://kind.sigs.k8s.io/docs/user/quick-start/">Kind Quick Start</a></li>
</ul>
<h2 id="kubectl">kubectl</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat <span style="color:#e6db74">&lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[kubernetes]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">name=Kubernetes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-\$basearch
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">enabled=1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">gpgcheck=1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>sudo yum install -y kubectl
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;exclude=kubectl&#34;</span> &gt;&gt; /etc/dnf/dnf.conf
</span></span><span style="display:flex;"><span>kubectl version --output<span style="color:#f92672">=</span>yaml <span style="color:#75715e"># 打印版本信息，当前为v1.27.3</span>
</span></span></code></pre></div><p>版本信息如下：（因为cluster还没起来，所以没有server的信息</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">clientVersion</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">buildDate</span>: <span style="color:#e6db74">&#34;2023-06-14T09:53:42Z&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">compiler</span>: <span style="color:#ae81ff">gc</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">gitCommit</span>: <span style="color:#ae81ff">25b4e43193bcda6c7328a6d147b1fb73a33f1598</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">gitTreeState</span>: <span style="color:#ae81ff">clean</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">gitVersion</span>: <span style="color:#ae81ff">v1.27.3</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">goVersion</span>: <span style="color:#ae81ff">go1.20.5</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">major</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">minor</span>: <span style="color:#e6db74">&#34;27&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">platform</span>: <span style="color:#ae81ff">linux/amd64</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kustomizeVersion</span>: <span style="color:#ae81ff">v5.0.1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">The connection to the server localhost:8080 was refused - did you specify the right host or port?</span>
</span></span></code></pre></div><h2 id="kind">kind</h2>
<h3 id="安装kind">安装kind</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># For AMD64 / x86_64</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> <span style="color:#66d9ef">$(</span>uname -m<span style="color:#66d9ef">)</span> <span style="color:#f92672">=</span> x86_64 <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.20.0/kind-linux-amd64
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For ARM64</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> <span style="color:#66d9ef">$(</span>uname -m<span style="color:#66d9ef">)</span> <span style="color:#f92672">=</span> aarch64 <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> curl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.20.0/kind-linux-arm64
</span></span><span style="display:flex;"><span>chmod +x ./kind
</span></span><span style="display:flex;"><span>sudo mv ./kind /usr/local/bin/kind
</span></span><span style="display:flex;"><span>kind --version <span style="color:#75715e"># 当前版本为0.20.0</span>
</span></span></code></pre></div><h3 id="创建cluster">创建cluster</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>yum install -y podman <span style="color:#75715e"># 安装podman</span>
</span></span><span style="display:flex;"><span>kind create cluster --name demo --wait 5m 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 使用默认的node image创建cluster。https://hub.docker.com/r/kindest/node/。 </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># kind 版本和镜像版本有对应关系，在release页面查看 https://github.com/kubernetes-sigs/kind/releases</span>
</span></span></code></pre></div><p>输出：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>enabling experimental podman provider
</span></span><span style="display:flex;"><span>Creating cluster <span style="color:#e6db74">&#34;demo&#34;</span> ...
</span></span><span style="display:flex;"><span> ✓ Ensuring node image <span style="color:#f92672">(</span>kindest/node:v1.27.3<span style="color:#f92672">)</span> 🖼 
</span></span><span style="display:flex;"><span> ✓ Preparing nodes 📦  
</span></span><span style="display:flex;"><span> ✓ Writing configuration 📜 
</span></span><span style="display:flex;"><span> ✓ Starting control-plane 🕹️ 
</span></span><span style="display:flex;"><span> ✓ Installing CNI 🔌 
</span></span><span style="display:flex;"><span> ✓ Installing StorageClass 💾 
</span></span><span style="display:flex;"><span> ✓ Waiting ≤ 5m0s <span style="color:#66d9ef">for</span> control-plane <span style="color:#f92672">=</span> Ready ⏳ 
</span></span><span style="display:flex;"><span> • Ready after 17s 💚
</span></span><span style="display:flex;"><span>Set kubectl context to <span style="color:#e6db74">&#34;kind-demo&#34;</span>
</span></span><span style="display:flex;"><span>You can now use your cluster with:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>kubectl cluster-info --context kind-demo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Have a question, bug, or feature request? Let us know! https://kind.sigs.k8s.io/#community
</span></span></code></pre></div><p>此时，查看podman的容器列表，可以看到：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># podman ps</span>
</span></span><span style="display:flex;"><span>CONTAINER ID  IMAGE                                                                                           COMMAND     CREATED        STATUS        PORTS                      NAMES
</span></span><span style="display:flex;"><span>6313438e57a5  docker.io/kindest/node@sha256:3966ac761ae0136263ffdb6cfd4db23ef8a83cba8a463690e98317add2c9ba72              <span style="color:#ae81ff">5</span> minutes ago  Up <span style="color:#ae81ff">5</span> minutes  127.0.0.1:39025-&gt;6443/tcp  demo-control-plane
</span></span></code></pre></div><p>使用kubectl查看cluster信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># kubectl version --output=yaml</span>
</span></span><span style="display:flex;"><span>clientVersion:
</span></span><span style="display:flex;"><span>  buildDate: <span style="color:#e6db74">&#34;2023-06-14T09:53:42Z&#34;</span>
</span></span><span style="display:flex;"><span>  compiler: gc
</span></span><span style="display:flex;"><span>  gitCommit: 25b4e43193bcda6c7328a6d147b1fb73a33f1598
</span></span><span style="display:flex;"><span>  gitTreeState: clean
</span></span><span style="display:flex;"><span>  gitVersion: v1.27.3
</span></span><span style="display:flex;"><span>  goVersion: go1.20.5
</span></span><span style="display:flex;"><span>  major: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  minor: <span style="color:#e6db74">&#34;27&#34;</span>
</span></span><span style="display:flex;"><span>  platform: linux/amd64
</span></span><span style="display:flex;"><span>kustomizeVersion: v5.0.1
</span></span><span style="display:flex;"><span>serverVersion:
</span></span><span style="display:flex;"><span>  buildDate: <span style="color:#e6db74">&#34;2023-06-15T00:36:28Z&#34;</span>
</span></span><span style="display:flex;"><span>  compiler: gc
</span></span><span style="display:flex;"><span>  gitCommit: 25b4e43193bcda6c7328a6d147b1fb73a33f1598
</span></span><span style="display:flex;"><span>  gitTreeState: clean
</span></span><span style="display:flex;"><span>  gitVersion: v1.27.3
</span></span><span style="display:flex;"><span>  goVersion: go1.20.5
</span></span><span style="display:flex;"><span>  major: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>  minor: <span style="color:#e6db74">&#34;27&#34;</span>
</span></span><span style="display:flex;"><span>  platform: linux/amd64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># kubectl cluster-info         </span>
</span></span><span style="display:flex;"><span>Kubernetes control plane is running at https://127.0.0.1:39025
</span></span><span style="display:flex;"><span>CoreDNS is running at https://127.0.0.1:39025/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>To further debug and diagnose cluster problems, use <span style="color:#e6db74">&#39;kubectl cluster-info dump&#39;</span>.
</span></span></code></pre></div><p>再看看 <code>~/.kube/config</code> 集群配置文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">clusters</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">cluster</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">certificate-authority-data</span>: <span style="color:#ae81ff">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMvakNDQWVhZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJek1EY3hPREV5TXpNME0xb1hEVE16TURjeE5URXlNek0wTTFvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTUFECjdUWUhBUUkyQUtDQlNOMzZaTm1YSVFnZFNrR0sxNTIySzhvclJHZlBmTVBueWJsbWNheTJzKzQxZ05nVUZPQm0KUGRNODIwbUNvdEY2U09nWHNULzI4cWdWL2pBRVB3bWhkMDJHa2k2VXZXWVNDb2hxRE10cHpDRks5U3VSZkdOSApsOG5JczlSR2RsYzVteXkyVXJwM3hYcEIyVThqYkxDcUdmOFJoSmVpK0ZmSzQxNUtqRkY0bGpyZmxvK1hwbk5OCnFCYXAxbUFpNmp1SzYzeDhpbDFFTWtvV3pCdmhQOWwvY2Y1bkRZNnAxcHh2cm5nUzR0UTFraitRRnhNMlovK3EKd05WbTZNUytMd044c1BhNE9sOGF3L3RmbGg5OVJscExzemNTTjlpRlRUNk5zdXYxdTJVc3ZHQkJLZVFRVUliVwpYaWZlU0plV1lVd01oTGp3a2ZjQ0F3RUFBYU5aTUZjd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZQVVBFdCtPbzdPaFlZa0FsTkZjaTkwODlmaGJNQlVHQTFVZEVRUU8KTUF5Q0NtdDFZbVZ5Ym1WMFpYTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBQWp6WWNJaWZqZzZxenloekdkZgpobmQwaVY2ZlEwcHI1SGNPVFdVL2lXRUtKbmJYdncvK1FVMjRIYmJaYU5GL01JaktRMDdReTdEZVBERGdRTGdvCkw5SFQ2ODFPeFJpU1dEWkMrUzBFRmRmMk82cEhtbnFOVDluQTN6VnRzOGFvZnljZ0JTamg0WFg2Z3ZMUFVVZDMKNDMxVG9hZUU0eDNtbWNDcGNUdTNZNk1sQm1ZcCtCVkdHZk0xTDJIenE3L0VNZWRCVU13Z2ZKVEhPL2w3d3ZwWApNWXF2c0VFUnVXdEhBR2xrV0hmWTVya3ZtdVRpbG8veFhkQ2xWaGVxUFhTMG81Ulo5Z3g3L2N1WE1NVUJKbTI3Cmk2ZzVJQm94VkJrZzhsd3UxbHFJNlFjQVd4Ryt0RFlweVE4SVIzOWxpSzUxNnI3c2lPSmRDWnM3T0dudy9EaVMKL2xJPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server</span>: <span style="color:#ae81ff">https://127.0.0.1:39025</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">contexts</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">context</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cluster</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">user</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">current-context</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Config</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">preferences</span>: {}
</span></span><span style="display:flex;"><span><span style="color:#f92672">users</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">user</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">client-certificate-data</span>: <span style="color:#ae81ff">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURJVENDQWdtZ0F3SUJBZ0lJSVd1TEZtRlFEY3N3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TXpBM01UZ3hNak16TkROYUZ3MHlOREEzTVRjeE1qTXpORFZhTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXZtd0phU3FCeGhkWnhPUlYKaSsvckpMdDdxallXN0FXZGptc0NYNmxxM2EvVVNMbHNwYU0rYitISTVUcnJ4RnRSd2gwQXI0cVRTRnZiNnh0cwpuM3VTbnNUMFlDOGkxWWxUTnVzbExxVjJyYVlZQzF5c2ZQMVBsTnl5ZEJlUU90ZHNBWEhuOExtUEJZN2tpaEFjCjdDU0dpTUdxWFppS1U4QXRpVXZ6RzZmV1ZjTjliTDNjQ1BoaEtiWE96ZzBDM3dXMkZTczBWMHVXc0ttMjcvWEEKTlR3NkZneE9scndoTkRiRVVxZFJoUmpmSHNGT01mQVVScjhTRUs2LzhrQ2c2bzhmUlQ1cUtwTkVzNzdnZTE1dApQUkNqWmhJemJRQ3BFVUIxZERvMW5BUndDeWZiQ2pCd0RkU1ViYWk3RkJwd0pleThYcWQwcFBCaThOU2ZTb0RCCktxLytNd0lEQVFBQm8xWXdWREFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RBWURWUjBUQVFIL0JBSXdBREFmQmdOVkhTTUVHREFXZ0JUMUR4TGZqcU96b1dHSkFKVFJYSXZkUFBYNApXekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBY0dJNXhVZ25XeHRTZ3V0aEVNMUdxdk5JRGI3TlNLaUhTNHplCmFxTkNVb1lVRUtPNzBxYmFLTHdXbUw2REx2U0xzQlpYSWI2SE1OeXlZNEVSS2F0eWl1ZlpkUEJYSlg2WEptdUcKSDRLczBjQmxHRUhhbThpZlFsRDlvYXRhOVBxdlFSMkc1Njc5SnJYK3EyQnMxTElqWSszNUxQUGJWSzBJZlBOdQpMaDdaUTJhZVdXRTlXVW0rNkkvT0Z0R0xKbzd3L3I4bEhKemxITktRMGJpNzgwUnZRNDB5YzlRVnBnRWY2NEcrCjRJclJMVnFyOVp1SlRMVXpZREFhWG5ZVW5UUEx0MnAwZElDMzYrYlpGSlc4Q0syS3ZKeC8rcnpNamIzTWVLdXMKdzBRemQyVmxTZHord0hNUmZsclVCV2lIcFJTU2p4aTRrL25tSiswdER5YnN5akNSYVE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">client-key-data</span>: <span style="color:#ae81ff">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb2dJQkFBS0NBUUVBdm13SmFTcUJ4aGRaeE9SVmkrL3JKTHQ3cWpZVzdBV2RqbXNDWDZscTNhL1VTTGxzCnBhTStiK0hJNVRycnhGdFJ3aDBBcjRxVFNGdmI2eHRzbjN1U25zVDBZQzhpMVlsVE51c2xMcVYycmFZWUMxeXMKZlAxUGxOeXlkQmVRT3Rkc0FYSG44TG1QQlk3a2loQWM3Q1NHaU1HcVhaaUtVOEF0aVV2ekc2ZldWY045YkwzYwpDUGhoS2JYT3pnMEMzd1cyRlNzMFYwdVdzS20yNy9YQU5UdzZGZ3hPbHJ3aE5EYkVVcWRSaFJqZkhzRk9NZkFVClJyOFNFSzYvOGtDZzZvOGZSVDVxS3BORXM3N2dlMTV0UFJDalpoSXpiUUNwRVVCMWREbzFuQVJ3Q3lmYkNqQncKRGRTVWJhaTdGQnB3SmV5OFhxZDBwUEJpOE5TZlNvREJLcS8rTXdJREFRQUJBb0lCQUdJSXBOK3JycHdaTVhJWQpTNko3cGdlSExpZDNLVjNobGpmWUI2VFFSK0JSd1d5ZmFidnN5eHcybFlMT1Rzc01hSThTOTJOb2FHTDhSOEJHCm9pbUpLUGJzVnhPZHNNVldxYXpBYXFnVkw0QSszbW9iRUFKWk56dGdVODlJd2t4STA2WDZ5bm80VGRXQ3QwNE0KOVpidFJ3WHBEcGlaQzc0S1ZtYzAzcmdDTkdwNkV0aG1mbWtGcmd1UlBDSS9tT3d3MXlHcWZ2WWlJRytEbERKTgpWYzNYQzByR3FISGpiZWdYUG9CUENFTE80amwrYzl2cUl0RjgzUHoxb3RtYUhydzhINnR6Q0tGeHoyTDBKbGsrCjF2cnNMWnRLeXRMeUcvbVdHOE03ak0yVnRBR2FNT0EycFhQT0dZQWNrSmlFZlYrM3BJN1lOYm9LNEszSVluVmwKVG40SWFTRUNnWUVBMGJIZVg3Ujg0T0szVjNlUXZ4a0NEcm1zNG5zckF5azdEV3JDdDNlblBUQjdVbkNKQ01KNgpaNU1JR3hzNHROVHZYWEh0cFBvZ3BPOHFZWlY1SHBUNkZrc3RiMytCaXFlRXpHMlRmMFdUOXlYUzFKZU9BeFhDCnVaWjhNRnJ6UWpCeG5Wa3RoM0dzM3AwaHBNdzJZaE9LbGt3T21HdVJFTlpnOGI2eUlvRHBabmNDZ1lFQTZIaXIKaVRPME8xZjNDR0lVdjRMT2ZIUkczYlRvT2tuU2ZCS09pYXdub1JNeWtxWSsvbiszNFplN0VieTA0TzRnM3F5SwpTaTgyWGwzNzhxLzE2VXNIZEV2MXNiUXZuV3dUS1B3UE52bU9vc2t1dVFVZXhSZmFNd0pScEMvbWhwSm04dHh5CkNXWkI1R0oyd09ZWWcrc1NvVjFmZnJNUitBejM4TEpTbkpMMkNTVUNnWUJ2WnVCdDFkUTJJUndvRXJSS1liM1AKRnVON0d0WTZBckNGcXo4dyt4ZFZFYW1pblhpZnQ3b1J4bklhL0hZKzA1VXEvcml5MmROMzdEdUd4a01uZFJ2Nwp0Z3E0WG5QeXRwWjlpSVZBcXpVMXF0bDc2ZHdmVlhNeTUzaW9zOWppUkJ4SDdMV2NiRTdib1h6Yk1VWi9Da1NwCkhsVHVzczdKdENxaW81MjlhT0VXZHdLQmdEYWtCazJkWllOOVRZY2U1cG1NK1ZPdlVPalRtTEg2b0FxaG9mY2kKQzc2RWNLS2ZpTGJ3OWh1RU9tZ1Uzcjd2dWJJZEEvUWozTGVaaDVxbldUbVlkUXdVdm84aU52N2RaRE9CNjJHVQpqcjRjWTJzQmxSWG1ZVmNUK0hTSy9iZ3J1UjdrU2JtRDI0RCswOExMVW4vUFJQWEFxSzF6RVlvb0lpN2sreDNxClBRSXhBb0dBZUdiUlJjSlRwUXAzRmlMQ1E0VFpmeHAzUmUwalNXZTBScTFlUUpoekNySm1qRVZkbnArUzdYZUoKbnpaYVBOdGphWnFWbFVPN1k3a2RYay9jRThJTWFla2huR2h5cjFkL1J3L21GdDdySnBoekdYMlFPdTBCNzZNQQpEWUhRQTNrSVJoRmRDajF3MVkzalBPYVFqc2pUZ25CbUZLWDZYSENZYllkbDFKaXA2MkE9Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==</span>
</span></span></code></pre></div><p>我们再创建一个 <code>prod</code> 集群：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kind create cluster --name prod --wait 5m
</span></span></code></pre></div><p>再看 kubeconfig文件，可以看到两个context，两个cluster，两个user</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">clusters</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">cluster</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">certificate-authority-data</span>: <span style="color:#ae81ff">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMvakNDQWVhZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJek1EY3hPREV5TXpNME0xb1hEVE16TURjeE5URXlNek0wTTFvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTUFECjdUWUhBUUkyQUtDQlNOMzZaTm1YSVFnZFNrR0sxNTIySzhvclJHZlBmTVBueWJsbWNheTJzKzQxZ05nVUZPQm0KUGRNODIwbUNvdEY2U09nWHNULzI4cWdWL2pBRVB3bWhkMDJHa2k2VXZXWVNDb2hxRE10cHpDRks5U3VSZkdOSApsOG5JczlSR2RsYzVteXkyVXJwM3hYcEIyVThqYkxDcUdmOFJoSmVpK0ZmSzQxNUtqRkY0bGpyZmxvK1hwbk5OCnFCYXAxbUFpNmp1SzYzeDhpbDFFTWtvV3pCdmhQOWwvY2Y1bkRZNnAxcHh2cm5nUzR0UTFraitRRnhNMlovK3EKd05WbTZNUytMd044c1BhNE9sOGF3L3RmbGg5OVJscExzemNTTjlpRlRUNk5zdXYxdTJVc3ZHQkJLZVFRVUliVwpYaWZlU0plV1lVd01oTGp3a2ZjQ0F3RUFBYU5aTUZjd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZQVVBFdCtPbzdPaFlZa0FsTkZjaTkwODlmaGJNQlVHQTFVZEVRUU8KTUF5Q0NtdDFZbVZ5Ym1WMFpYTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBQWp6WWNJaWZqZzZxenloekdkZgpobmQwaVY2ZlEwcHI1SGNPVFdVL2lXRUtKbmJYdncvK1FVMjRIYmJaYU5GL01JaktRMDdReTdEZVBERGdRTGdvCkw5SFQ2ODFPeFJpU1dEWkMrUzBFRmRmMk82cEhtbnFOVDluQTN6VnRzOGFvZnljZ0JTamg0WFg2Z3ZMUFVVZDMKNDMxVG9hZUU0eDNtbWNDcGNUdTNZNk1sQm1ZcCtCVkdHZk0xTDJIenE3L0VNZWRCVU13Z2ZKVEhPL2w3d3ZwWApNWXF2c0VFUnVXdEhBR2xrV0hmWTVya3ZtdVRpbG8veFhkQ2xWaGVxUFhTMG81Ulo5Z3g3L2N1WE1NVUJKbTI3Cmk2ZzVJQm94VkJrZzhsd3UxbHFJNlFjQVd4Ryt0RFlweVE4SVIzOWxpSzUxNnI3c2lPSmRDWnM3T0dudy9EaVMKL2xJPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server</span>: <span style="color:#ae81ff">https://127.0.0.1:39025</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">cluster</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">certificate-authority-data</span>: <span style="color:#ae81ff">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUMvakNDQWVhZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJek1EY3hPREV5TlRNd09Wb1hEVE16TURjeE5URXlOVE13T1Zvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBT1FiCm1mY1htUGlORnlyWVFqZmd4WSs0Y2dqeFhVdUc2Nlp3SGpMS1I4VzlSbzJvTVdOZ0tqS3J5VkFXNTl4eVd3MnEKVEkzYVhZNmFUZkQweWZsQU9sRjFjTDZpdzU1YmVMSUdoZFlJcG1lWVozdjRPQ1g4OHlHRzZqNlZ6L1dnOGd4dQpCN01IV2YzQ0RvTk8yTHF4VzhaQVh0Ny9HTWNxMmZqSjRmZFlwU2E4emQ5UjlucVkrbkNCcVNkTDE4UXFlRXVNCkdWa3VpZHREMUFqSng3di8zVGhNNHhwUldlYWZYNXZrZ3lwdm82dTlSdC9YeUwvVUI3NWg5bjlvRkNJRFlJMHgKUk1uaDFUQTgvK0pDeE1VZWQwbzdnbE0rVXlNRElNbUNvZjVpSUNRcTFQN1cxNmQwalB0NWU1dmM5UHlqVUIyUQpIUFkybTdBNFhIbGtoWXZnM3c4Q0F3RUFBYU5aTUZjd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZBOWlxWFRyYk43U1BQak84eGZtUmpiK3RPUm5NQlVHQTFVZEVRUU8KTUF5Q0NtdDFZbVZ5Ym1WMFpYTXdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBSi9FdFpvZWE1TDVyTkEwemI0dAprSERZNjFPb2d3bTJUWXBpczJuTDNzcGttSnFTK3B1WnRqaUQwczhjUGZQSGdtKzhrblpyUzcwelErOGZwdXA3CmVyV3VxSmNvOVpDTXZxRHBTR3ljUWFOdDlkeERkdWVqU0JLZkNiaXRaSnRwa01QTGtXNHRmV1VSOTdTVmFJeFkKY0t3dGltWlBKVVZ6NUJMUTBJY0hzMWFBS0puN3lKaXloVWlpR1lRQ0h2d0hzUHBDMW94SEFMY3ZPeGZscGRlOAo4MzJ2dlpKNVRGbGdSVXRWUFRoSG45bmthWmhpYXBEOGljcURnUElCU2lZMTBkamd4eW1SbGlJS1JzckY0dHRjCmwwNWlISzIzQzZYQjlkU0tkUGhHeU1LaFROMDB1OEVWMktjREUybUFHRk1KUHZsTDFQVlo3WlJMMmdQV2NrV3AKNmFnPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">server</span>: <span style="color:#ae81ff">https://127.0.0.1:46229</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kind-prod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">contexts</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">context</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cluster</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">user</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">context</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cluster</span>: <span style="color:#ae81ff">kind-prod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">user</span>: <span style="color:#ae81ff">kind-prod</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kind-prod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">current-context</span>: <span style="color:#ae81ff">kind-prod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Config</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">preferences</span>: {}
</span></span><span style="display:flex;"><span><span style="color:#f92672">users</span>:
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kind-demo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">user</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">client-certificate-data</span>: <span style="color:#ae81ff">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURJVENDQWdtZ0F3SUJBZ0lJSVd1TEZtRlFEY3N3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TXpBM01UZ3hNak16TkROYUZ3MHlOREEzTVRjeE1qTXpORFZhTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXZtd0phU3FCeGhkWnhPUlYKaSsvckpMdDdxallXN0FXZGptc0NYNmxxM2EvVVNMbHNwYU0rYitISTVUcnJ4RnRSd2gwQXI0cVRTRnZiNnh0cwpuM3VTbnNUMFlDOGkxWWxUTnVzbExxVjJyYVlZQzF5c2ZQMVBsTnl5ZEJlUU90ZHNBWEhuOExtUEJZN2tpaEFjCjdDU0dpTUdxWFppS1U4QXRpVXZ6RzZmV1ZjTjliTDNjQ1BoaEtiWE96ZzBDM3dXMkZTczBWMHVXc0ttMjcvWEEKTlR3NkZneE9scndoTkRiRVVxZFJoUmpmSHNGT01mQVVScjhTRUs2LzhrQ2c2bzhmUlQ1cUtwTkVzNzdnZTE1dApQUkNqWmhJemJRQ3BFVUIxZERvMW5BUndDeWZiQ2pCd0RkU1ViYWk3RkJwd0pleThYcWQwcFBCaThOU2ZTb0RCCktxLytNd0lEQVFBQm8xWXdWREFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RBWURWUjBUQVFIL0JBSXdBREFmQmdOVkhTTUVHREFXZ0JUMUR4TGZqcU96b1dHSkFKVFJYSXZkUFBYNApXekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBY0dJNXhVZ25XeHRTZ3V0aEVNMUdxdk5JRGI3TlNLaUhTNHplCmFxTkNVb1lVRUtPNzBxYmFLTHdXbUw2REx2U0xzQlpYSWI2SE1OeXlZNEVSS2F0eWl1ZlpkUEJYSlg2WEptdUcKSDRLczBjQmxHRUhhbThpZlFsRDlvYXRhOVBxdlFSMkc1Njc5SnJYK3EyQnMxTElqWSszNUxQUGJWSzBJZlBOdQpMaDdaUTJhZVdXRTlXVW0rNkkvT0Z0R0xKbzd3L3I4bEhKemxITktRMGJpNzgwUnZRNDB5YzlRVnBnRWY2NEcrCjRJclJMVnFyOVp1SlRMVXpZREFhWG5ZVW5UUEx0MnAwZElDMzYrYlpGSlc4Q0syS3ZKeC8rcnpNamIzTWVLdXMKdzBRemQyVmxTZHord0hNUmZsclVCV2lIcFJTU2p4aTRrL25tSiswdER5YnN5akNSYVE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">client-key-data</span>: <span style="color:#ae81ff">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb2dJQkFBS0NBUUVBdm13SmFTcUJ4aGRaeE9SVmkrL3JKTHQ3cWpZVzdBV2RqbXNDWDZscTNhL1VTTGxzCnBhTStiK0hJNVRycnhGdFJ3aDBBcjRxVFNGdmI2eHRzbjN1U25zVDBZQzhpMVlsVE51c2xMcVYycmFZWUMxeXMKZlAxUGxOeXlkQmVRT3Rkc0FYSG44TG1QQlk3a2loQWM3Q1NHaU1HcVhaaUtVOEF0aVV2ekc2ZldWY045YkwzYwpDUGhoS2JYT3pnMEMzd1cyRlNzMFYwdVdzS20yNy9YQU5UdzZGZ3hPbHJ3aE5EYkVVcWRSaFJqZkhzRk9NZkFVClJyOFNFSzYvOGtDZzZvOGZSVDVxS3BORXM3N2dlMTV0UFJDalpoSXpiUUNwRVVCMWREbzFuQVJ3Q3lmYkNqQncKRGRTVWJhaTdGQnB3SmV5OFhxZDBwUEJpOE5TZlNvREJLcS8rTXdJREFRQUJBb0lCQUdJSXBOK3JycHdaTVhJWQpTNko3cGdlSExpZDNLVjNobGpmWUI2VFFSK0JSd1d5ZmFidnN5eHcybFlMT1Rzc01hSThTOTJOb2FHTDhSOEJHCm9pbUpLUGJzVnhPZHNNVldxYXpBYXFnVkw0QSszbW9iRUFKWk56dGdVODlJd2t4STA2WDZ5bm80VGRXQ3QwNE0KOVpidFJ3WHBEcGlaQzc0S1ZtYzAzcmdDTkdwNkV0aG1mbWtGcmd1UlBDSS9tT3d3MXlHcWZ2WWlJRytEbERKTgpWYzNYQzByR3FISGpiZWdYUG9CUENFTE80amwrYzl2cUl0RjgzUHoxb3RtYUhydzhINnR6Q0tGeHoyTDBKbGsrCjF2cnNMWnRLeXRMeUcvbVdHOE03ak0yVnRBR2FNT0EycFhQT0dZQWNrSmlFZlYrM3BJN1lOYm9LNEszSVluVmwKVG40SWFTRUNnWUVBMGJIZVg3Ujg0T0szVjNlUXZ4a0NEcm1zNG5zckF5azdEV3JDdDNlblBUQjdVbkNKQ01KNgpaNU1JR3hzNHROVHZYWEh0cFBvZ3BPOHFZWlY1SHBUNkZrc3RiMytCaXFlRXpHMlRmMFdUOXlYUzFKZU9BeFhDCnVaWjhNRnJ6UWpCeG5Wa3RoM0dzM3AwaHBNdzJZaE9LbGt3T21HdVJFTlpnOGI2eUlvRHBabmNDZ1lFQTZIaXIKaVRPME8xZjNDR0lVdjRMT2ZIUkczYlRvT2tuU2ZCS09pYXdub1JNeWtxWSsvbiszNFplN0VieTA0TzRnM3F5SwpTaTgyWGwzNzhxLzE2VXNIZEV2MXNiUXZuV3dUS1B3UE52bU9vc2t1dVFVZXhSZmFNd0pScEMvbWhwSm04dHh5CkNXWkI1R0oyd09ZWWcrc1NvVjFmZnJNUitBejM4TEpTbkpMMkNTVUNnWUJ2WnVCdDFkUTJJUndvRXJSS1liM1AKRnVON0d0WTZBckNGcXo4dyt4ZFZFYW1pblhpZnQ3b1J4bklhL0hZKzA1VXEvcml5MmROMzdEdUd4a01uZFJ2Nwp0Z3E0WG5QeXRwWjlpSVZBcXpVMXF0bDc2ZHdmVlhNeTUzaW9zOWppUkJ4SDdMV2NiRTdib1h6Yk1VWi9Da1NwCkhsVHVzczdKdENxaW81MjlhT0VXZHdLQmdEYWtCazJkWllOOVRZY2U1cG1NK1ZPdlVPalRtTEg2b0FxaG9mY2kKQzc2RWNLS2ZpTGJ3OWh1RU9tZ1Uzcjd2dWJJZEEvUWozTGVaaDVxbldUbVlkUXdVdm84aU52N2RaRE9CNjJHVQpqcjRjWTJzQmxSWG1ZVmNUK0hTSy9iZ3J1UjdrU2JtRDI0RCswOExMVW4vUFJQWEFxSzF6RVlvb0lpN2sreDNxClBRSXhBb0dBZUdiUlJjSlRwUXAzRmlMQ1E0VFpmeHAzUmUwalNXZTBScTFlUUpoekNySm1qRVZkbnArUzdYZUoKbnpaYVBOdGphWnFWbFVPN1k3a2RYay9jRThJTWFla2huR2h5cjFkL1J3L21GdDdySnBoekdYMlFPdTBCNzZNQQpEWUhRQTNrSVJoRmRDajF3MVkzalBPYVFqc2pUZ25CbUZLWDZYSENZYllkbDFKaXA2MkE9Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==</span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">name</span>: <span style="color:#ae81ff">kind-prod</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">user</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">client-certificate-data</span>: <span style="color:#ae81ff">LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURJVENDQWdtZ0F3SUJBZ0lJRUJPRkI3NFozdkV3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TXpBM01UZ3hNalV6TURsYUZ3MHlOREEzTVRjeE1qVXpNVEZhTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTd3VThuN3lHVzc2MGsydHMKbWxwemZlM2MzOHM5SUNKRDNMUjM4Z0FDaDdUYU8vTjVVRU1tS01iRFk2S0hOZjFFakFJdW9vNG9EakpFRlJIQgpvVlNtWGVERTZ2MDlLd1FYTk9pbm9VRDcxRm96OSs1ZVhlcmVRUkJkUGRpaWZab2FZTzV0N2ZTdTVqYWpTMUkzCk8rd1FyN0o3d3dPc3JhcEZJRmYvTFl2ODljcm0xVTE2QWQ3VFNwRWh6VjFPWFQyRE1sbzhwcXowNVpzUTV3VU8KUWNSZWNHQ0hCQ25tOVJlVXNxNnR2bnJGc0gvNnIrcXNTNVQxYmJXc3lEZ0wyenBtNmVoeHcvM2xibDVwUUxnSgo1RHh0SFF3SHdpM2p4RU1PMlFpdDdxZjFsUml5dmhENVNEalV0OTd5dSsvbFMwWlI2STJkYWgyMFZta3dCeVk5CkdUaVBqd0lEQVFBQm8xWXdWREFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0RBWURWUjBUQVFIL0JBSXdBREFmQmdOVkhTTUVHREFXZ0JRUFlxbDA2MnplMGp6NHp2TVg1a1kyL3JUawpaekFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBczNKbHlnQlgzNWhCZ3VTTndLMHowUUNYcTRydDRxZ1ZXam5zCk9zWTAzRUpmMVhiMnVvS0xnSW9yVy9KVzZqYWNHdXo2ZWl6TzRjSXFMcTV1dWhROEhybnhqVGVmNDgzSGdmdjYKbmQ1SXZDNHFWZUt6WDd0eVlOLzVlM1Z0ZmhkK0JUUTVMWTBNNGpkMVhXL3dWQi9IdU8rUmhNN1hhNUo0alJGagphSHp2QkdFR0M1UDltbzdmM3VUTlNBdnAwbGRzMS9HTHRCWjYva3NjbllGQ0hudWpDdUdUNmdBdWh3Nkt1VURQCncwMzExbHFlVjZxRzBSWHF6KzIxcjNTUzBCWE82UHBqN0VvQzhnbWltS0p2OEU4Q01rajU1bXByMCtBa2NZRUYKMExnSW1IbTEyRHorVmlZbUlWT1RidWRzNkYxTEt3d01yUmQ2WFdlQlFUQ1VIb04vSlE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">client-key-data</span>: <span style="color:#ae81ff">LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcFFJQkFBS0NBUUVBN3dVOG43eUdXNzYwazJ0c21scHpmZTNjMzhzOUlDSkQzTFIzOGdBQ2g3VGFPL041ClVFTW1LTWJEWTZLSE5mMUVqQUl1b280b0RqSkVGUkhCb1ZTbVhlREU2djA5S3dRWE5PaW5vVUQ3MUZvejkrNWUKWGVyZVFSQmRQZGlpZlpvYVlPNXQ3ZlN1NWphalMxSTNPK3dRcjdKN3d3T3NyYXBGSUZmL0xZdjg5Y3JtMVUxNgpBZDdUU3BFaHpWMU9YVDJETWxvOHBxejA1WnNRNXdVT1FjUmVjR0NIQkNubTlSZVVzcTZ0dm5yRnNILzZyK3FzClM1VDFiYldzeURnTDJ6cG02ZWh4dy8zbGJsNXBRTGdKNUR4dEhRd0h3aTNqeEVNTzJRaXQ3cWYxbFJpeXZoRDUKU0RqVXQ5N3l1Ky9sUzBaUjZJMmRhaDIwVm1rd0J5WTlHVGlQandJREFRQUJBb0lCQVFES2V1YzJjbUJuakJBdwo2a25nSUV2Q0hDU0dPUWVaRnkzaDQ4ZlFiQTI0cEk1VFJ4ZzMxQXFaZEhmRkNjUDlDb1p0RE5Rd3hMaE4vbXNLClpqWmYwdlAwaHhxSjd1bEliWGl6UzN2bDhNVGt5VjFJNU5kd1BDejNkVU5ueHdNdjM4SUU1emFjNUREZHVOOXcKU1QrZE5ZZVZMMkFFZmpKa0U5L25YR1JCVTF1Qll6UWk3RHVSUXlJNWRzdnBvNjgrNlhqY2p6alZRSy9RTklvagpsbGVuVEpJL243a1ZnZ1FXMDZkdkJaeURlWVhlKzJkNm9KZG9tTEwrTlRSVndmdng3dVpVSWNxYXpzSWpRN0E5CmtVWWVyWVhkcTZpejZZWUZHQkVkY0J6L0pPQlV3N2VWMnBhNjdXd3lXdWxGWVFJZVY2TktjYW1oZTRXUGlYOUgKdEgwY2pQRXhBb0dCQVB5WXNNR0tqWGc2ek1JeXJkU2ZXWVplT0JneENXU0p2SGdNTUxjMHZ4ei8zSjA3NG0zTgo4dXoxMFBtbG5JNkxFTE9VUWRXUG9lV2ZFL2dTbFVGL1dLdmhSKzRnVGozbTIxd2lGODNHNEF4cFVpbW80OUdwClI4enhUT3hDbThyVVNwSytXS1pVd1V6c2lobkM4czQwUEJlTFU5d2lCaFdyR01pdXF0c00xcHRWQW9HQkFQSTkKdDVlR3p0T2FSOFAzd2hLZHNVUXdyWmc1V3ZyaGVzaUR4UE9lVG50MHAvekJpcmxBdFZuVFFMY3VmQnBqazlMSApWTUp3bGJtMFJnc3AzTHd4cGpXSEl4YWptTXdmZ1IzcXNFTzJ5dldFQitVcVBSOStSSVNWa1I3QmFDU01XVkNIClBXMEQ2eTVwMURDY005T1R0Mm44eG12ZzRZUnlER0J4SFprc2tXZFRBb0dCQU1DdG5FN1Y2Rm5veUYzdUdJa1MKMEZCZHVINURrWDJlVHlSbmNCV2Y1NVF3VzlHWVozMEkxeUFIMWxOSUQrYnZqMXJjWVdlTk81cVRRTUUvTTVrVgprY2J5ZmxMWFU3ZUdUSmUzN2Q1cXNHYm5RK1JCVHg2VCtSQU1sSGUzeTJ6cGlNVHM2MlJkVEdIb0lPUEx3RGlvCndabllEcXpoU3pEbUpXNlhSZjczaVJCTkFvR0JBS3dpWXhXUHUrVHRtdFdNZHlJWFlHSGVYVnp3Vk5BMTdiUVMKdnArRy9Lb0pxVjJZZ21WRnNCaVdYMFJNQ2ZBT2xucVBIcEhVd3ZCbFEraW01SzN1Y2ZkVGdnR1NXditoMjNSUQowdFFyVG1uTVduZmozZTlGSUpjK1dSTUx5RjlBUkM5UENyMHVyYTRia2FiQk9LcStLdlZybyt3QXJ3QVlzdWJOCk9vVWdBR3IxQW9HQUM3cEY0MTZxenFtRHhRL0dqNXpvanpWMzFDRzdDRTRHYlh1SWlHNkVYMyt5NTd0VEhzcDgKWFhZOTA1R0xveEZHanR6eHRxcnE1WjNVcWdPSFQvdk1sRGdMZjBsbmk0MG95VE50MXRnYWRvMUk2TXlJVVovSwo5c2VoOUsraDdNcGVENEF4NGcrUm5TWmRpNlI0eHFOY1BTSllOaXU3UXZJNTdlNG1lY3lzWmw4PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=</span>
</span></span></code></pre></div><p>可以使用 <code>--context</code>指定集群和user</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl cluster-info --context kind-prod
</span></span></code></pre></div><h3 id="删除集群">删除集群</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kind delete cluster --name prod
</span></span><span style="display:flex;"><span>kubectl config use-context kind-demo <span style="color:#75715e"># 将current-context设置为之前的demo集群</span>
</span></span></code></pre></div><h3 id="将docker镜像加载到cluster中">将docker镜像加载到cluster中</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>podman build -t rust_http_proxy .
</span></span><span style="display:flex;"><span>podman tag rust_http_proxy:latest rust_http_proxy:1.0 <span style="color:#75715e"># k8s的Kubernetes imagePullPolicy 不允许使用latest的镜像。所以给个版本标记</span>
</span></span><span style="display:flex;"><span>yum install -y docker <span style="color:#75715e"># 安装podman的docker兼容层，用于下面的docker-image命令</span>
</span></span><span style="display:flex;"><span>kind load docker-image rust_http_proxy:1.0 --name demo
</span></span><span style="display:flex;"><span>podman exec -it demo-control-plane crictl images <span style="color:#75715e"># 查看集群中的镜像列表</span>
</span></span></code></pre></div><p>集群中的镜像列表如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ae81ff">IMAGE                                      TAG                  IMAGE ID            SIZE</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">docker.io/arloor/rust_http_proxy           1.0                  540e623206d7e       22.2MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">docker.io/kindest/kindnetd                 v20230511-dc714da8   b0b1fa0f58c6e       27.7MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">docker.io/kindest/local-path-helper        v20230510-486859a6   be300acfc8622       3.05MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">docker.io/kindest/local-path-provisioner   v20230511-dc714da8   ce18e076e9d4b       19.4MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">localhost/rust_http_proxy                  1.0                  65631e7a5e1da       22.2MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">registry.k8s.io/coredns/coredns            v1.10.1              ead0a4a53df89       16.2MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">registry.k8s.io/etcd                       3.5.7-0              86b6af7dd652c       102MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">registry.k8s.io/kube-apiserver             v1.27.3              c604ff157f0cf       83.5MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">registry.k8s.io/kube-controller-manager    v1.27.3              9f8f3a9f3e8a9       74.4MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">registry.k8s.io/kube-proxy                 v1.27.3              9d5429f6d7697       72.7MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">registry.k8s.io/kube-scheduler             v1.27.3              205a4d549b94d       59.8MB</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">registry.k8s.io/pause                      3.7                  221177c6082a8       311kB</span>
</span></span></code></pre></div><h3 id="进入控制面看看">进入控制面看看</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;podman exec -it demo-control-plane /bin/bash&#34;</span> &gt; /usr/local/bin/pssh
</span></span><span style="display:flex;"><span>chmod +x /usr/local/bin/pssh
</span></span><span style="display:flex;"><span>pssh
</span></span></code></pre></div><p>设置下容器内的apt镜像 debian11</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">## 阿里云镜像</span>
</span></span><span style="display:flex;"><span>cat &gt; /etc/apt/sources.list <span style="color:#e6db74">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb https://mirrors.aliyun.com/debian/ bullseye main non-free contrib
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb-src https://mirrors.aliyun.com/debian/ bullseye main non-free contrib
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb https://mirrors.aliyun.com/debian-security/ bullseye-security main
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb-src https://mirrors.aliyun.com/debian-security/ bullseye-security main
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb https://mirrors.aliyun.com/debian/ bullseye-updates main non-free contrib
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb-src https://mirrors.aliyun.com/debian/ bullseye-updates main non-free contrib
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb https://mirrors.aliyun.com/debian/ bullseye-backports main non-free contrib
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb-src https://mirrors.aliyun.com/debian/ bullseye-backports main non-free contrib
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 腾讯云内网镜像</span>
</span></span><span style="display:flex;"><span>cat &gt; /etc/apt/sources.list <span style="color:#e6db74">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb http://mirrors.tencentyun.com/debian/ bullseye main contrib non-free
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb-src http://mirrors.tencentyun.com/debian/ bullseye main contrib non-free
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb http://mirrors.tencentyun.com/debian/ bullseye-updates main contrib non-free
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb-src http://mirrors.tencentyun.com/debian/ bullseye-updates main contrib non-free
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb http://mirrors.tencentyun.com/debian/ bullseye-backports main contrib non-free
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb-src http://mirrors.tencentyun.com/debian/ bullseye-backports main contrib non-free
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb http://mirrors.tencentyun.com/debian-security/ bullseye-security main contrib non-free
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">deb-src http://mirrors.tencentyun.com/debian-security/ bullseye-security main contrib non-free
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 这些Http代理环境变量是从主机传递过来的，如果不想要的话</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 可以删除当前集群，然后清空http代理，重新闯将</span>
</span></span><span style="display:flex;"><span>cat &gt;&gt; ~/.bashrc <span style="color:#e6db74">&lt;&lt;EOF 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">export https_proxy=
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">export http_proxy=
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">export HTTP_PROXY=
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">export HTTPS_PROXY=
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>apt update
</span></span><span style="display:flex;"><span>apt install -y vim
</span></span></code></pre></div><h3 id="创建工作负载">创建工作负载</h3>
<p><a href="https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/">assign-pods-nodes</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># 给控制面node增加label app=all</span>
</span></span><span style="display:flex;"><span>kubectl label nodes demo-control-plane app<span style="color:#f92672">=</span>all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 加载镜像，并将镜像导入到集群</span>
</span></span><span style="display:flex;"><span>podman pulll docker.io/arloor/rust_http_proxy
</span></span><span style="display:flex;"><span>podman tag docker.io/arloor/rust_http_proxy:latest rust_http_proxy:1.0
</span></span><span style="display:flex;"><span>kind load docker-image rust_http_proxy:1.0 --name demo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 独立启动pod</span>
</span></span><span style="display:flex;"><span>kubectl run proxy --image<span style="color:#f92672">=</span>localhost/rust_http_proxy:1.0
</span></span><span style="display:flex;"><span>kubectl get pods --show-labels
</span></span><span style="display:flex;"><span>kubectl delete pod proxy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">## 通过deployment启动pod</span>
</span></span><span style="display:flex;"><span>cat &gt; a.yaml <span style="color:#e6db74">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">apiVersion: apps/v1
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">kind: Deployment
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">metadata:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  name: proxy-deployment
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">spec:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  replicas: 1 # tells deployment to run 2 pods matching the template
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  selector:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    matchLabels:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      app: all
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  template:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    metadata:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      labels:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        app: all
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    spec:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      containers:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      - name: proxy
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        image: localhost/rust_http_proxy:1.0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        ports:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        - containerPort: 3128
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span><span style="display:flex;"><span>kubectl apply -f a.yaml <span style="color:#75715e"># 新建一个deployment</span>
</span></span><span style="display:flex;"><span>kubectl get deployments --show-labels
</span></span></code></pre></div>
  </div>
  

<div class="navigation navigation-single">
    
    <a href="/posts/java-memory-monitor/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Java内存监控</span>
    </a>
    
    
    <a href="/posts/k8s-kubeadm/" class="navigation-next">
      <span class="navigation-tittle">使用Kubeadm安装K8S 1.27.3</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  


</article>


        </div>
        
    



<script defer src="/js/all.js" crossorigin="anonymous"></script>

    
    
    <script src="/js/highlight.min.js"></script>
    <script src="/js/languages/dos.min.js"></script>
        
    <script type="text/javascript">
        
        hljs.highlightAll();
    </script>
    




    



    </body>
</html>
