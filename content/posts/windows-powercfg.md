---
title: "Windows10电源管理-睡眠问题解决"
date: 2019-07-07T11:40:52+08:00
draft: false
categories: [ "undefined"]
tags: ["undefined"]
weight: 10
subtitle: ""
description : ""
keywords:
- 刘港欢 arloor moontell
---

这是很久之前写在CSDN上的一篇文章，现在迁移到自己的博客上，主要介绍windows10睡眠、电源管理方面的问题。
<!--more-->

新入手了thinkpad x1 carbon 2018，定位轻薄便携总不能每次在外需要使用时都重新开关机，于是研究了一下win10关于睡眠的东西。下面是一些记录，防止遗忘。

## 查看本机支持的电源状态

启动powershell(管理员权限)，输入`powercfg /a`查看电脑上支持的电源状态。如下，我的本本当前支持待机、休眠、混合睡眠、快速启动。快速启动就不说了，这是win10加快启动速度的一个技术吧，其实这里的快速启动状态应该就是关机。

![](/img/window10-powerstatus.png)

## 待机、休眠、混合睡眠是什么？

待机（s3）：指除了内存外的所有设备断电，只有内存继续运行。由内存保存系统运行状态，当恢复使用时，从内存恢复状态。这种情况下，恢复使用可以认为只要1秒钟。这里的待机（s3）在电源选项中又被称为睡眠，如下：

![](/img/windows10-power-control.png)

休眠：将系统运行状态保存在硬盘。由于内存是易失的（断电丢失存储内容），断电系统状态就丢失了。但休眠将系统运行状态保存在硬盘（非易失），就算断电，也不会丢失系统运行状态。

混合睡眠：在台式机电脑上用的多。将状态既保存在内存上，又保存在硬盘上，好处不多说。

## 开启s3待机模式——笔记本盒盖就走

进入s3待机，只有内存耗电，这代表着耗电、发热大户都不工作，这样不怕x1c放在包里疯狂耗电、疯狂发热。
要做的有以下几步：

1.首先确保当前支持的待机是s3,而不是其他（s1、s1或者微软的modern sleep），也是上面的powercfg /a显示支持“待机(s3)”。

这个支持与不支持是主板bios的责任。在x1c 2018 1.30之前版本的bios中并不支持s3待机，在1.30及以后才加入了s3待机。

2.其次，快捷键进入睡眠。在x1c上只要安装了联想hotkey的驱动，就可以使用fn+4按键进入睡眠，恢复使用时按fn即可。

3.其他会出现的问题：插着电源时，按fn+4或者关闭盖子或者按电源菜单中的睡眠都无法进入睡眠（移动下鼠标屏幕就亮了）。在windows社区中，有关于这个问题的讨论，问题出在“离开模式”。有些应用会阻止睡眠，防止网络等设备中断，最典型的是迅雷和百度网盘这种，他们会设置“离开模式”，阻止睡眠。解决方法如下：修改注册表，禁止离开模式。

![](/img/likaimoshi.png)

![](/img/regitedit.png)

完成以上三步，就可以“稳定地”进入睡眠模式，确保每次盒盖都能睡眠，安心将本子放入背包。

## 禁用“休眠”

上一节确保盒盖后进入s3待机，但是在待机久了之后再恢复使用，要闪一下windows田字格，并且耗时长一点

这个原因是，待机久了，系统自动进入“休眠”状态。上面说过，这个状态是将状态保存在硬盘上，这也是耗时长的原因。我们只需要进入“睡眠”，不需要也不喜欢进入“休眠”，下面就介绍如何禁用这个机制。

禁用这个“待机（睡眠）久了，自动进入休眠”的设定：将以下“在此时间后休眠”设定为0（也就是从不），这样就可以保证不会进入睡眠了。

![](/img/no-xiumian.png)

## 睡眠状态监控

使用`powercfg /sleepstudy`命令来生成睡眠状态报告的html文件。
然后在浏览器浏览 file:///C:/Windows/system32/sleepstudy-report.html 这个地址可以看到如下：

![](/img/sleepstudy.png)

这里可以看到有一次进入了Standby (Hybrid)。这是混合睡眠的状态。因为我们在电池选项中开启了支持混合睡眠。在一开始我提到，混合睡眠是又保存在内存中，又保存在硬盘中，其实完全没有必要保存在硬盘中，我决定关掉他。现在就关：

![](/img/no-hunheshuimian.png)

这时再按fn+4进入睡眠，然后powercfg /sleepstudy生成报告，去查看这次睡眠的状态显示如下：

![](/img/sleepstudy2.png)

可以看到，最新的一次睡眠（待机s3），已经不是Standby (Hybrid)了。

## 保护电池的一些做法：

- 不要把电池用到低电量再充电。
- 不要一直不用电池的电量。
- 不要过充电（设置充电阈值）
